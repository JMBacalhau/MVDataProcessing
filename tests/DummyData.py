# -*- coding: utf-8 -*-
"""
Created on Mon May 30 05:52:19 2022

@author: Bacalhau
"""


import pandas
import numpy
import datetime
import random
import datetime as dt

def CurrentDummyData():
    
    
    dummy_day = pandas.DataFrame([[129.2,122.5,118.8,4.7],
                                [126.3,122.5,118.8,4.7],
                                [131.3,123,120.9,5.6],
                                [126.9,121.5,117.8,5],
                                [126.9,121.5,117.8,5],
                                [125.4,118.8,116.6,5],
                                [125.4,118.8,118.5,4.6],
                                [124.8,117.1,116.6,4.6],
                                [125.7,118.8,116.1,5],
                                [125.7,118.8,113.5,4.6],
                                [125.1,117.4,115,4.5],
                                [125.1,117.4,115,4.5],
                                [122.8,115.3,113.5,4.7],
                                [122.4,113.8,114.7,4.7],
                                [122.4,113.8,114.7,4.7],
                                [120.9,114.9,111.5,4.6],
                                [120.9,111.9,107.8,4.6],
                                [120.2,114.1,107.8,4.6],
                                [116.2,114.1,107.8,4.6],
                                [119.1,114.5,108.3,4.8],
                                [119.3,112.2,110.5,4.9],
                                [116.3,112.2,110.5,4.9],
                                [117.7,110.7,109.1,4.6],
                                [117.7,110.7,109.1,4.7],
                                [116.9,109.4,107.6,4.7],
                                [116.3,110.5,109.8,4.5],
                                [116.3,110.5,109.8,4.5],
                                [117,110.8,107.5,4.3],
                                [117,110.8,107.5,4.3],
                                [116.3,110.3,107.5,4.6],
                                [116,106.7,108,4.2],
                                [116,106.7,108,4.2],
                                [113.7,108.1,105.5,4.5],
                                [113.7,108.1,105.5,4.5],
                                [115.9,106.8,106.6,4.7],
                                [113.8,108.6,105.7,4.9],
                                [116.4,108.6,105.7,4.8],
                                [114.1,107.5,107.8,4.6],
                                [114.1,107.5,107.8,4.6],
                                [114.7,108.4,105.6,4.5],
                                [111.3,108.1,105.4,4.1],
                                [111.3,108.1,102.8,4.1],
                                [112.5,105.7,103.9,4.4],
                                [112.5,105.7,103.9,4.4],
                                [111.1,106.5,103.5,4.2],
                                [112,106,104,4.2],
                                [112,106,104,4.2],
                                [111.5,106.5,102.5,4.3],
                                [111.5,106.5,102.5,4.3],
                                [112.3,106.5,104.4,4.5],
                                [112,107.1,104.7,4.5],
                                [112,107.1,104.7,4.5],
                                [113.9,107.5,104.6,4.4],
                                [113.9,107.5,104.6,4.4],
                                [110.9,105.3,101.9,4.5],
                                [111.4,105.7,103.2,4.4],
                                [111.4,105.7,103.2,4.4],
                                [111.4,106.2,107.8,4.5],
                                [111.4,106.2,102.7,4.5],
                                [110.6,108.3,101.8,4.3],
                                [109.6,105,102.6,4.7],
                                [106.3,105,102.6,4.7],
                                [111.3,105.2,102.5,4.6],
                                [111.3,105.2,102.5,4.6],
                                [110.1,101.8,102.5,4.7],
                                [110.3,105.8,102,4.3],
                                [110.3,101.9,102,4.3],
                                [107.3,101.3,98.2,3.7],
                                [107.3,101.3,102.7,4.8],
                                [105.6,103.2,97.7,4.2],
                                [107.4,103.7,100.8,4.4],
                                [107.4,103.5,104.9,4.4],
                                [103.5,100.1,100.8,4.2],
                                [103.5,100.1,100.8,3.8],
                                [113.6,113,105.4,5.1],
                                [112.2,110.1,105.9,4.8],
                                [112,111.9,111.2,4],
                                [108.4,110.1,100.8,4.2],
                                [114.3,110.3,105.9,4.2],
                                [109.2,111.1,106.1,3.8],
                                [112.7,105.7,105.4,3.9],
                                [113.4,107.7,105.6,3.9],
                                [112.6,107.6,105.6,3.6],
                                [113.7,111.5,106,3.6],
                                [115.3,111.5,104.5,3.8],
                                [114.3,110.9,108.2,3.9],
                                [120.4,114.1,107.2,3.9],
                                [115,112.3,109.7,3.9],
                                [120.2,117.6,109.7,5.1],
                                [117.3,115.8,111.3,4.1],
                                [115,112.5,108.9,3.8],
                                [117.7,112.5,113.8,3.8],
                                [119.3,115.6,110.3,3.9],
                                [124.5,115.6,112.2,3.9],
                                [121.3,118,114.5,3.8],
                                [125.9,120.1,115.7,3.7],
                                [125.9,120.9,119.7,3.7],
                                [127.3,123,121.1,3.6],
                                [129.8,123.6,121.3,3.6],
                                [128.8,122.4,120.8,3.7],
                                [127,123.4,121.4,3.6],
                                [128.5,118.8,121.4,3.6],
                                [129.4,124.4,122.3,3.5],
                                [130.2,123.2,121.3,3.5],
                                [134.5,128.9,129.2,3.4],
                                [128.6,121,124.1,3.4],
                                [133.1,126.8,128.1,2.9],
                                [133.4,123.5,122,4],
                                [137.9,125.3,127.2,4],
                                [133.9,124.1,126.6,3.5],
                                [133.3,129.6,126.6,2.9],
                                [134.2,131.5,130.8,3.9],
                                [135.9,135.3,129.7,3.9],
                                [135.4,133.5,129.7,3.9],
                                [138.9,134.4,128.5,3.4],
                                [134.6,133.6,128.9,3.7],
                                [134.5,129,129,3.7],
                                [134.8,132,129.6,3.2],
                                [140.3,135.5,130.4,4.1],
                                [141.3,132.8,131.2,3.8],
                                [137.8,130.3,129,3.8],
                                [143.1,135.8,134,5.2],
                                [138,129.8,127.6,4.2],
                                [137.4,132.1,129.3,4.2],
                                [139.7,132.6,125.3,3.8],
                                [140.5,137.4,135,3],
                                [143,140.3,136.3,4.1],
                                [142.2,137.9,134.9,3.6],
                                [144.5,136.9,135,3.6],
                                [144.6,144.8,135.5,3.7],
                                [142.8,138.9,134.4,3.7],
                                [145.5,146.9,138.7,3.7],
                                [145.3,141.8,138.7,4.2],
                                [147.4,142.4,138.1,4.5],
                                [143.7,143.4,136.9,3.5],
                                [142,144.7,141.2,4.1],
                                [151.1,149.6,135.9,3.8],
                                [147.2,138.7,129.7,3.8],
                                [150.8,144.8,139.8,3.8],
                                [146.9,141.5,138.6,3.7],
                                [157.3,153.7,140.5,3.7],
                                [146.6,141.2,146.7,3.3],
                                [147.3,142.6,141.1,3.8],
                                [148.9,142.1,142.7,3.8],
                                [147.2,139.6,140.7,3.5],
                                [160.6,157.9,143.6,3.5],
                                [155.6,149.2,143,3.6],
                                [149.2,146.5,140.3,4],
                                [156.5,159.6,139.5,4],
                                [151.1,146.3,143.4,3.7],
                                [146.7,142.1,143.7,3.7],
                                [149.5,143.4,140.8,3.9],
                                [145.2,138.3,135.6,3.6],
                                [146.8,138.2,138.6,3.6],
                                [148.4,140.4,137.6,3.5],
                                [144.7,140.8,137.7,3.5],
                                [145.5,142.1,138.4,3.9],
                                [143.3,143.1,138.9,3.5],
                                [151.5,143.6,140.8,3.5],
                                [148,145.9,141.8,3.3],
                                [148.3,146.7,144.7,3.3],
                                [149.3,143.8,139.9,3.9],
                                [149.2,144.9,140.1,3.4],
                                [150,149.4,141.8,3.4],
                                [147,143.3,137.9,3.6],
                                [146.2,144.9,139,3.6],
                                [148.8,146.1,138.9,3.7],
                                [147.5,143,140.7,3.7],
                                [149.9,143.5,136.1,3.7],
                                [149.9,144.3,137.1,3.4],
                                [146.2,144.2,137.3,3.4],
                                [154,150.9,142.1,3.3],
                                [147,143.3,141.3,3.3],
                                [148.3,149.3,139.6,3.8],
                                [149.4,146.8,140.5,3.5],
                                [150.4,148,142.3,3.5],
                                [149.3,144.9,142.4,3.7],
                                [149.7,146.6,140.3,3.4],
                                [147.1,146.6,140.2,4.3],
                                [148.5,146.6,137.7,3.7],
                                [145.6,142.9,138.6,3.7],
                                [147,145.4,140.7,2.9],
                                [148.4,145.4,141.1,2.8],
                                [148.6,144.8,141.1,3.7],
                                [143.5,139.8,137.4,3.4],
                                [149,145.2,141.3,3.4],
                                [149.3,150.8,141.8,3.9],
                                [146.6,146.4,139.4,3.9],
                                [149.5,146.4,142.4,3.8],
                                [149.7,142.8,142.1,3.5],
                                [149.7,146.6,142.1,3.8],
                                [150,151.6,147.2,3.2],
                                [150.6,147.1,142.8,4],
                                [149.8,151.9,142,3.6],
                                [150.2,149.1,142.5,3.6],
                                [149.8,147.7,142.3,3.9],
                                [150.5,150.2,147.1,3.9],
                                [150.4,147.2,145.2,4.1],
                                [146.9,146.6,142.9,4.1],
                                [148.8,141.5,142.9,3.9],
                                [147,146.6,142.9,3.9],
                                [146.8,147.2,142.8,3.6],
                                [144.7,142.4,138.6,3.5],
                                [152.4,152.2,143.1,3.5],
                                [153.2,152.4,148.2,4.5],
                                [148.1,147.4,143.1,4.5],
                                [148.3,147.5,142.7,3.8],
                                [148.1,147.7,142.7,3.8],
                                [148.4,147.2,142.9,3.7],
                                [155.2,153,148.2,3.8],
                                [148.4,147.7,143.3,3.8],
                                [148.7,148.6,143.9,4.1],
                                [159.1,152.7,154.2,4.2],
                                [159.5,159.3,154.5,5.2],
                                [161.6,159.6,155.1,5],
                                [159.2,159.5,153.8,4.2],
                                [159.2,159.3,149,4.3],
                                [158.7,154.2,149.3,4.3],
                                [164.4,159.3,154.6,4.5],
                                [159.5,154.2,149,4.5],
                                [164.7,154.2,154.5,4.5],
                                [159.3,154.3,149.4,5],
                                [159.4,154.3,149.4,5],
                                [164.7,159.2,154.8,4.5],
                                [159.7,155.8,152.2,4.2],
                                [164.9,159,154.7,4.2],
                                [165,159.1,155,5.6],
                                [159.5,153.9,149.9,5.6],
                                [164.6,155,155.3,5.3],
                                [159.3,159.4,155.3,4.6],
                                [159.5,155.8,155.2,5.5],
                                [159.1,160.5,157,5.3],
                                [164.5,160.5,159.9,4.5],
                                [163.4,160.6,149.7,5.1],
                                [164.4,160,155,5.6],
                                [165.1,160,155,4.5],
                                [160.1,160.3,154.7,5],
                                [159.7,160.4,149.4,5],
                                [164.7,160.3,154.6,4.3],
                                [166.6,160.9,158.8,4.6],
                                [164.7,155.2,159.9,4.6],
                                [159.7,155.6,149.6,5.5],
                                [159.3,155.4,154.7,4.5],
                                [160.2,154.3,149.6,5.6],
                                [158.8,155.5,148.2,5.1],
                                [155.2,155.5,144.3,5.1],
                                [158.9,155.6,155.1,5.3],
                                [158.9,155.6,150,5.3],
                                [155.5,155,150.1,5.6],
                                [159.3,155.7,147.1,5.5],
                                [155.8,149.6,147.1,5.5],
                                [150.7,151.3,143.9,5],
                                [150.8,144.5,139.5,5.5],
                                [155.1,149.6,144.7,6.7],
                                [153.6,147.7,143.1,5.4],
                                [150.2,149.8,139.7,5.4],
                                [149.6,149.7,140.8,5.1],
                                [149.6,149.7,140.8,5.8],
                                [155.3,150.1,143.4,5.8],
                                [148.1,145,140.1,5.5],
                                [145.7,145.4,140.9,4.8],
                                [145.8,140.2,135.8,5.3],
                                [145.8,140.2,135.8,4.9],
                                [147.9,134.9,134,5.2],
                                [144.2,138.2,134.9,5.3],
                                [144.2,138.2,134.9,5.3],
                                [145.7,140.8,135.5,4.9],
                                [145.7,140.9,135.5,4.9],
                                [147.6,145.9,136.7,6],
                                [144,140.1,133.6,4.9],
                                [144,140.6,133.6,4.9],
                                [147,141.7,135.5,6],
                                [147,141.7,130.4,5],
                                [145.7,140.8,134.9,4.9],
                                [139.6,135.5,128.2,4.9],
                                [145.7,135.5,134.9,4.9],
                                [140.7,134.3,131,5],
                                [140.7,134.3,131,5],
                                [135.7,129.5,124.8,5.1],
                                [136.7,132.7,126,5.7],
                                [136.7,135.6,126,5.7],
                                [136.5,130.3,125.4,5.3],
                                [135.9,130.3,125.4,6],
                                [135.8,125.2,125.9,5],
                                [135.2,130,128.3,5.8],
                                [135.2,130,128.3,5],
                                [134.1,129.4,126,5.3],
                                [131.1,125.1,119.6,5.3]],columns = ['IA','IB','IV','IN'])
    start_date='2021-01-01'
    final_date='2023-01-01'
    
    start_date_dt = dt.datetime(int(start_date.split("-")[0]),int(start_date.split("-")[1]),int(start_date.split("-")[2]))
    end_date_dt = dt.datetime(int(final_date.split("-")[0]),int(final_date.split("-")[1]),int(final_date.split("-")[2]))
     
    dummy = numpy.arange(start_date_dt, end_date_dt,numpy.timedelta64(5,'m'), dtype='datetime64')
    dummy = pandas.DataFrame(dummy,columns=['timestamp'])            
    dummy.set_index('timestamp', inplace=True)
    
    
    aux_day = pandas.concat([dummy_day]*int(dummy.shape[0]/dummy_day.shape[0]), ignore_index=True)
    
    
    cycles = 0.7*dummy.shape[0]/(365*24*12) # how many sine cycles
    resolution = aux_day.shape[0] # how many datapoints to generate    
    length = numpy.pi * 2 * cycles
    season_year = numpy.sin(numpy.arange(0, length, length / resolution))

    cycles = 12*4*dummy.shape[0]/(365*24*12) # how many sine cycles
    resolution = aux_day.shape[0] # how many datapoints to generate    
    length = numpy.pi * 2 * cycles
    season_week = numpy.sin(numpy.arange(0, length, length / resolution))


    cycles = 12*dummy.shape[0]/(365*24*12) # how many sine cycles
    resolution = aux_day.shape[0] # how many datapoints to generate    
    length = numpy.pi * 2 * cycles
    season_month = numpy.sin(numpy.arange(0, length, length / resolution))
    
    rand_year = random.randint(5, 10)
    rand_month = random.randint(1, 5)
    rand_week = random.randint(1, 3)
    
    rand_vet = numpy.random.randint(5, 10,size=dummy.shape[0])
    step_vet = numpy.zeros(dummy.shape[0])
    
    #Load transfer
    for i in range(0,random.randint(1, 4)):
        start = random.randint(0, dummy.shape[0])    
        end = start+random.randint(1, 60)*24*12
        
        if(end>=len(step_vet)): end=len(step_vet)
        
        step_vet[start:end] = random.randint(-50,-20)
        
    #Noise
    for i in range(0,random.randint(1, 40)):
        start = random.randint(0, dummy.shape[0])    
        end = start+random.randint(1,12*3)
        
        if(end>=len(step_vet)): end=len(step_vet)
        
        step_vet[start:end] = random.randint(-300,300)

        
    
    dummy['IA'] = aux_day['IA'].values + rand_year*season_year + rand_month*season_month + rand_week*season_week + rand_vet + step_vet
    dummy['IB'] = aux_day['IB'].values + rand_year*season_year + rand_month*season_month + rand_week*season_week + rand_vet + step_vet
    dummy['IV'] = aux_day['IV'].values + rand_year*season_year + rand_month*season_month + rand_week*season_week + rand_vet + step_vet
    dummy['IN'] = aux_day['IN'].values + (rand_year/10)*season_year + (rand_month/10)*season_month + (rand_week/10)*season_week + rand_vet/10

    return dummy